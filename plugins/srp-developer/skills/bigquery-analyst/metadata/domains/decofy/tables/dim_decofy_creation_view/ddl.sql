CREATE VIEW `srpproduct-dc37e.favie_dw.dim_decofy_creation_view`
AS SELECT
        json_value(to_json_string(data._id.`$oid`)) as _id,
        to_json_string(data.color_palette) as color_palette,
        timestamp_millis(safe_cast(json_value(to_json_string(data.created_at.`$date`)) as int64)) as created_at,
        json_value(to_json_string(data.creation_id)) as creation_id,
        to_json_string(data.creation_plan) as creation_plan,
        json_extract_array(to_json_string(data.creation_products)) as creation_products,
        json_value(to_json_string(data.creation_url)) as creation_url,
        timestamp_millis(safe_cast(json_value(to_json_string(data.deleted_at.`$date`)) as int64)) as deleted_at,
        json_value(to_json_string(data.design_style)) as design_style,
        json_value(to_json_string(data.feed_id)) as feed_id,
        json_value(to_json_string(data.feed_product_id)) as feed_product_id,
        safe_cast(json_value(to_json_string(data.generation_time_taken)) as numeric) as generation_time_taken,
        safe_cast(json_value(to_json_string(data.plan_time_taken)) as numeric) as plan_time_taken,
        json_value(to_json_string(data.primary_entry_id)) as primary_entry_id,
        to_json_string(data.product_images) as product_images,
        json_value(to_json_string(data.project_id)) as project_id,
        json_value(to_json_string(data.prompt)) as prompt,
        json_value(to_json_string(data.quality)) as quality,
        json_value(to_json_string(data.query)) as query,
        to_json_string(data.query_image_sizes) as query_image_sizes,
        json_extract_array(to_json_string(data.query_images)) as query_images,
        json_value(to_json_string(data.remix_id)) as remix_id,
        json_value(to_json_string(data.room_type)) as room_type,
        json_value(to_json_string(data.search_country)) as search_country,
        safe_cast(json_value(to_json_string(data.search_time_taken)) as numeric) as search_time_taken,
        to_json_string(data.searched_products) as searched_products,
        json_value(to_json_string(data.status)) as status,
        to_json_string(data.style_images) as style_images,
        timestamp_millis(safe_cast(json_value(to_json_string(data.updated_at.`$date`)) as int64)) as updated_at,
        json_value(to_json_string(data.user_id)) as user_id
    FROM `srpproduct-dc37e.mongo_production.decofy_creations`;