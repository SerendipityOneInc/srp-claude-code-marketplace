CREATE VIEW `srpproduct-dc37e.favie_dw.dim_gem_user_view`
AS SELECT
  user_id,
  device_id,
  user_email,
  user_name,
  true as is_registered_user,
  is_effective_user,
  geos,
  last_continent,
  last_sub_continent,
  last_country,
  last_region,
  last_metro,
  last_city,
  updated_date,
  created_date,
  updated_time,
  created_time,
  device_ids,
  dt,
FROM gensmo_dim.dim_gensmo_registered_user_full_1d
union all
SELECT
  cast(null as STRING) as user_id,
  device_id,
  cast(null as STRING) user_email,
  cast(null as STRING) user_name,
  false as is_registered_user,
  cast(null as boolean) is_effective_user,
  geos,
  last_continent,
  last_sub_continent,
  last_country,
  last_region,
  last_metro,
  last_city,
  updated_date,
  created_date,
  updated_time,
  created_time,
  null as device_ids,
  dt,
FROM gensmo_dim.dim_gensmo_unregistered_user_full_1d;