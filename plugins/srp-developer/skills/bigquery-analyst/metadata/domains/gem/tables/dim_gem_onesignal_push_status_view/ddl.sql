CREATE VIEW `srpproduct-dc37e.favie_dw.dim_gem_onesignal_push_status_view`
AS SELECT  
        json_value(to_json_string(data._id.`$oid`)) as _id,
        json_value(to_json_string(data.adm_big_picture)) as adm_big_picture,
        json_value(to_json_string(data.adm_group)) as adm_group,
        json_value(to_json_string(data.adm_large_icon)) as adm_large_icon,
        json_value(to_json_string(data.adm_small_icon)) as adm_small_icon,
        json_value(to_json_string(data.adm_sound)) as adm_sound,
        json_value(to_json_string(data.alexa_display_title)) as alexa_display_title,
        json_value(to_json_string(data.alexa_ssml)) as alexa_ssml,
        json_value(to_json_string(data.amazon_background_data)) as amazon_background_data,
        json_value(to_json_string(data.android_accent_color)) as android_accent_color,
        json_value(to_json_string(data.android_group)) as android_group,
        json_value(to_json_string(data.android_group_message)) as android_group_message,
        json_value(to_json_string(data.android_led_color)) as android_led_color,
        json_value(to_json_string(data.android_sound)) as android_sound,
        safe_cast(json_value(to_json_string(data.android_visibility)) as int64) as android_visibility,
        to_json_string(data.apns_alert) as apns_alert,
        json_value(to_json_string(data.app_id)) as app_id,
        json_value(to_json_string(data.app_url)) as app_url,
        json_value(to_json_string(data.big_picture)) as big_picture,
        to_json_string(data.buttons) as buttons,
        safe_cast(json_value(to_json_string(data.canceled)) as boolean) as canceled,
        json_value(to_json_string(data.chrome_big_picture)) as chrome_big_picture,
        json_value(to_json_string(data.chrome_icon)) as chrome_icon,
        json_value(to_json_string(data.chrome_web_badge)) as chrome_web_badge,
        json_value(to_json_string(data.chrome_web_icon)) as chrome_web_icon,
        json_value(to_json_string(data.chrome_web_image)) as chrome_web_image,
        timestamp_seconds(safe_cast(json_value(to_json_string(data.completed_at)) as int64)) as completed_at,
        json_value(to_json_string(data.content_available)) as content_available,
        to_json_string(data.contents) as contents,
        safe_cast(json_value(to_json_string(data.converted)) as int64) as converted,
        to_json_string(data.data) as data_field,
        json_value(to_json_string(data.delayed_option)) as delayed_option,
        json_value(to_json_string(data.delivery_time_of_day)) as delivery_time_of_day,
        safe_cast(json_value(to_json_string(data.email_click_tracking_disabled)) as boolean) as email_click_tracking_disabled,
        json_value(to_json_string(data.email_from_address)) as email_from_address,
        json_value(to_json_string(data.email_from_name)) as email_from_name,
        json_value(to_json_string(data.email_preheader)) as email_preheader,
        json_value(to_json_string(data.email_reply_to_address)) as email_reply_to_address,
        json_value(to_json_string(data.email_subject)) as email_subject,
        safe_cast(json_value(to_json_string(data.errored)) as int64) as errored,
        json_extract_array(to_json_string(data.excluded_segments)) as excluded_segments,
        safe_cast(json_value(to_json_string(data.failed)) as int64) as failed,
        json_value(to_json_string(data.fcap_group_ids)) as fcap_group_ids,
        json_value(to_json_string(data.fcap_status)) as fcap_status,
        timestamp_millis(safe_cast(json_value(to_json_string(data.fetched_at.`$date`)) as int64)) as fetched_at,
        to_json_string(data.filters) as filters,
        json_value(to_json_string(data.firefox_icon)) as firefox_icon,
        json_value(to_json_string(data.global_image)) as global_image,
        to_json_string(data.headings) as headings,
        json_value(to_json_string(data.huawei_accent_color)) as huawei_accent_color,
        json_value(to_json_string(data.huawei_bi_tag)) as huawei_bi_tag,
        json_value(to_json_string(data.huawei_big_picture)) as huawei_big_picture,
        json_value(to_json_string(data.huawei_category)) as huawei_category,
        json_value(to_json_string(data.huawei_channel_id)) as huawei_channel_id,
        json_value(to_json_string(data.huawei_existing_channel_id)) as huawei_existing_channel_id,
        json_value(to_json_string(data.huawei_group)) as huawei_group,
        json_value(to_json_string(data.huawei_group_message)) as huawei_group_message,
        json_value(to_json_string(data.huawei_large_icon)) as huawei_large_icon,
        json_value(to_json_string(data.huawei_led_color)) as huawei_led_color,
        json_value(to_json_string(data.huawei_msg_type)) as huawei_msg_type,
        json_value(to_json_string(data.huawei_small_icon)) as huawei_small_icon,
        json_value(to_json_string(data.huawei_sound)) as huawei_sound,
        json_value(to_json_string(data.huawei_visibility)) as huawei_visibility,
        json_value(to_json_string(data.id)) as id,
        to_json_string(data.include_aliases) as include_aliases,
        json_extract_array(to_json_string(data.include_external_user_ids)) as include_external_user_ids,
        json_extract_array(to_json_string(data.include_player_ids)) as include_player_ids,
        safe_cast(json_value(to_json_string(data.include_unsubscribed)) as boolean) as include_unsubscribed,
        json_extract_array(to_json_string(data.included_segments)) as included_segments,
        to_json_string(data.ios_attachments) as ios_attachments,
        safe_cast(json_value(to_json_string(data.ios_badgeCount)) as int64) as ios_badgeCount,
        json_value(to_json_string(data.ios_badgeType)) as ios_badgeType,
        json_value(to_json_string(data.ios_category)) as ios_category,
        json_value(to_json_string(data.ios_interruption_level)) as ios_interruption_level,
        safe_cast(json_value(to_json_string(data.ios_relevance_score)) as int64) as ios_relevance_score,
        json_value(to_json_string(data.ios_sound)) as ios_sound,
        safe_cast(json_value(to_json_string(data.isAdm)) as boolean) as isAdm,
        safe_cast(json_value(to_json_string(data.isAlexa)) as boolean) as isAlexa,
        safe_cast(json_value(to_json_string(data.isAndroid)) as boolean) as isAndroid,
        safe_cast(json_value(to_json_string(data.isChrome)) as boolean) as isChrome,
        safe_cast(json_value(to_json_string(data.isChromeWeb)) as boolean) as isChromeWeb,
        safe_cast(json_value(to_json_string(data.isEdge)) as boolean) as isEdge,
        safe_cast(json_value(to_json_string(data.isEmail)) as boolean) as isEmail,
        safe_cast(json_value(to_json_string(data.isFirefox)) as boolean) as isFirefox,
        safe_cast(json_value(to_json_string(data.isHuawei)) as boolean) as isHuawei,
        safe_cast(json_value(to_json_string(data.isIos)) as boolean) as isIos,
        safe_cast(json_value(to_json_string(data.isSMS)) as boolean) as isSMS,
        safe_cast(json_value(to_json_string(data.isSafari)) as boolean) as isSafari,
        safe_cast(json_value(to_json_string(data.isWP)) as boolean) as isWP,
        safe_cast(json_value(to_json_string(data.isWP_WNS)) as boolean) as isWP_WNS,
        json_value(to_json_string(data.large_icon)) as large_icon,
        json_value(to_json_string(data.name)) as name,
        to_json_string(data.platform_delivery_stats) as platform_delivery_stats,
        safe_cast(json_value(to_json_string(data.priority)) as int64) as priority,
        safe_cast(json_value(to_json_string(data.queued_at)) as int64) as queued_at,
        safe_cast(json_value(to_json_string(data.received)) as int64) as received,
        safe_cast(json_value(to_json_string(data.remaining)) as int64) as remaining,
        safe_cast(json_value(to_json_string(data.send_after)) as int64) as send_after,
        json_value(to_json_string(data.small_icon)) as small_icon,
        json_value(to_json_string(data.sms_from)) as sms_from,
        json_extract_array(to_json_string(data.sms_media_urls)) as sms_media_urls,
        json_value(to_json_string(data.spoken_text)) as spoken_text,
        json_value(to_json_string(data.subtitle)) as subtitle,
        safe_cast(json_value(to_json_string(data.successful)) as int64) as successful,
        to_json_string(data.tags) as tags,
        json_value(to_json_string(data.target_content_identifier)) as target_content_identifier,
        json_value(to_json_string(data.template_id)) as template_id,
        json_value(to_json_string(data.thread_id)) as thread_id,
        safe_cast(json_value(to_json_string(data.throttle_rate_per_minute)) as int64) as throttle_rate_per_minute,
        safe_cast(json_value(to_json_string(data.ttl)) as int64) as ttl,
        json_value(to_json_string(data.url)) as url,
        to_json_string(data.web_buttons) as web_buttons,
        json_value(to_json_string(data.web_push_topic)) as web_push_topic,
        json_value(to_json_string(data.web_url)) as web_url,
        json_value(to_json_string(data.wp_sound)) as wp_sound,
        json_value(to_json_string(data.wp_wns_sound)) as wp_wns_sound
    FROM `srpproduct-dc37e.mongo_production.copilot_gem_onesignal_push_status`;