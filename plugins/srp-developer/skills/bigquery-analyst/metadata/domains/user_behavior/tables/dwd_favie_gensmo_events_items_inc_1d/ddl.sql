CREATE TABLE `srpproduct-dc37e.favie_dw.dwd_favie_gensmo_events_items_inc_1d`
(
  dt DATE,
  session_id STRING,
  user_id STRING,
  device_id STRING,
  refer STRING,
  refer_pv_seq INT64,
  pre_refer STRING,
  cal_pre_refer STRING,
  cal_pre_refer_event STRUCT<ap_name STRING, event_name STRING, event_method STRING, event_action_type STRING>,
  cal_next_refer STRING,
  cal_refer_last_event STRUCT<ap_name STRING, event_name STRING, event_method STRING, event_action_type STRING>,
  ap_name STRING,
  user_pseudo_id STRING,
  user_login_type STRING,
  event_name STRING,
  event_method STRING,
  event_action_type STRING,
  event_ab_infos ARRAY<STRING>,
  event_item STRUCT<item_id STRING, item_name STRING, item_type STRING, item_index INT64>,
  event_interval FLOAT64,
  event_version STRING,
  event_source STRING,
  event_timestamp TIMESTAMP,
  event_uuid STRING,
  geo_continent_name STRING,
  geo_sub_continent_name STRING,
  geo_region_name STRING,
  geo_metro_name STRING,
  geo_country_name STRING,
  geo_city_name STRING,
  device_category STRING,
  device_mobile_brand_name STRING,
  device_mobile_model_name STRING,
  device_mobile_os_hardware_model STRING,
  device_operating_system STRING,
  device_operating_system_version STRING,
  device_vendor_id STRING,
  device_language STRING,
  device_is_limited_ad_tracking STRING,
  platform STRING,
  app_version STRING,
  web_version STRING,
  utm_source STRING,
  stream_id STRING,
  appsflyer_id STRING,
  home_request_seq INT64,
  home_request_first_event_name STRING,
  home_request_first_event_method STRING,
  home_request_first_event_action_type STRING,
  home_request_first_event_ap_name STRING,
  home_request_first_event_items ARRAY<STRUCT<item_id STRING, item_name STRING, item_type STRING, item_index INT64>>,
  app_version_seq INT64,
  web_version_seq INT64,
  event_version_seq INT64,
  refer_group STRING OPTIONS(description="来源分组，用于对有效来源值进行分组归类")
)
PARTITION BY dt
CLUSTER BY event_name
OPTIONS(
  require_partition_filter=true
);