CREATE VIEW `srpproduct-dc37e.favie_dw.dim_gem_task_response_view`
AS SELECT  
        json_value(to_json_string(data._id.`$oid`)) as _id,
        safe_cast(json_value(to_json_string(data.analysis_image_latency)) as float64) as analysis_image_latency,
        safe_cast(json_value(to_json_string(data.call_moodboard_latency)) as float64) as call_moodboard_latency,
        safe_cast(json_value(to_json_string(data.call_rag_latency)) as float64) as call_rag_latency,
        safe_cast(json_value(to_json_string(data.call_spider_product_latency)) as float64) as call_spider_product_latency,
        json_extract_array(to_json_string(data.call_steps)) as call_steps,
        to_json_string(data.debug_infos) as debug_infos,
        to_json_string(data.gem_debug_infos) as gem_debug_infos,
        json_value(to_json_string(data.gender)) as gender,
        json_value(to_json_string(data.generate_collage_context_input)) as generate_collage_context_input,
        safe_cast(json_value(to_json_string(data.generate_collage_context_latency)) as float64) as generate_collage_context_latency,
        to_json_string(data.generic_llm) as generic_llm,
        json_extract_array(to_json_string(data.ha3_moodboards)) as ha3_moodboards,
        json_value(to_json_string(data.ha3_plain_svg_text)) as ha3_plain_svg_text,
        json_value(to_json_string(data.image_description)) as image_description,
        json_value(to_json_string(data.image_url)) as image_url,
        safe_cast(json_value(to_json_string(data.include_image_file)) as boolean) as include_image_file,
        json_value(to_json_string(data.intention)) as intention,
        safe_cast(json_value(to_json_string(data.last_updated)) as int64) as last_updated,
        to_json_string(data.log_dict) as log_dict,
        to_json_string(data.moodboard_debug_infos) as moodboard_debug_infos,
        json_value(to_json_string(data.moodboard_more_response)) as moodboard_more_response,
        safe_cast(json_value(to_json_string(data.moodboard_size)) as int64) as moodboard_size,
        json_extract_array(to_json_string(data.moodboards)) as moodboards,
        to_json_string(data.more_infos) as more_infos,
        json_value(to_json_string(data.plain_svg_text)) as plain_svg_text,
        to_json_string(data.qr_result) as qr_result,
        json_value(to_json_string(data.query)) as query,
        json_value(to_json_string(data.rag_query)) as rag_query,
        json_value(to_json_string(data.reasoning)) as reasoning,
        json_extract_array(to_json_string(data.recording_task_latencys)) as recording_task_latencys,
        safe_cast(json_value(to_json_string(data.save_file_latency)) as float64) as save_file_latency,
        json_value(to_json_string(data.search)) as search,
        safe_cast(json_value(to_json_string(data.search_latency)) as float64) as search_latency,
        json_value(to_json_string(data.search_product)) as search_product,
        to_json_string(data.search_product_list) as search_product_list,
        to_json_string(data.spider_product_origin_url) as spider_product_origin_url,
        json_value(to_json_string(data.status)) as status,
        json_value(to_json_string(data.task_id)) as task_id,
        json_value(to_json_string(data.user_id)) as user_id,
        json_value(to_json_string(data.f_version)) as f_version,
        json_value(to_json_string(data.f_source)) as f_source,
        json_value(to_json_string(data.error_message)) as error_message,
        json_value(to_json_string(data.traceparent)) as traceparent,
        json_value(to_json_string(data.workflow)) as workflow,
        timestamp_millis(safe_cast(json_value(to_json_string(data.created_time.`$date`)) as int64)) as created_time
    FROM `srpproduct-dc37e.mongo_production.copilot_gem_task_response`;