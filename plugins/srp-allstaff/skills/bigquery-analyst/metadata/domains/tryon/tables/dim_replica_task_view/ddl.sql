CREATE VIEW `srpproduct-dc37e.favie_dw.dim_replica_task_view`
AS select 
        json_value(to_json_string(data._id.`$oid`)) as _id,
        json_value(to_json_string(data.cf_ipcountry)) as cf_ipcountry,
        safe_cast(json_value(to_json_string(data.completed_timestamp)) as int64) as completed_timestamp,
        timestamp_millis(safe_cast(json_value(to_json_string(data.created_time.`$date`)) as int64)) as created_time,
        safe_cast(json_value(to_json_string(data.cur_step)) as int64) as cur_step,
        json_value(to_json_string(data.f_source)) as f_source,
        json_value(to_json_string(data.f_version)) as f_version,
        json_value(to_json_string(data.generate_replica_trace_id)) as generate_replica_trace_id,
        json_value(to_json_string(data.id)) as id,
        safe_cast(json_value(to_json_string(data.is_valid)) as boolean) as is_valid,
        safe_cast(json_value(to_json_string(data.last_updated)) as int64) as last_updated,
        nullif(to_json_string(data.more_infos), 'null') as more_infos,
        nullif(to_json_string(data.preference), 'null') as preference,
        nullif(to_json_string(data.replica_list), 'null') as replica_list,
        safe_cast(json_value(to_json_string(data.replica_list_size)) as int64) as replica_list_size,
        json_value(to_json_string(data.replica_model_url)) as replica_model_url,
        json_value(to_json_string(data.replica_task_id)) as replica_task_id,
        safe_cast(json_value(to_json_string(data.skip_face_detection)) as boolean) as skip_face_detection,
        json_value(to_json_string(data.source_replica_model_url)) as source_replica_model_url,
        json_value(to_json_string(data.source_replica_task_id)) as source_replica_task_id,
        json_value(to_json_string(data.status)) as status,
        safe_cast(json_value(to_json_string(data.total_steps)) as int64) as total_steps,
        json_value(to_json_string(data.type)) as type,
        json_value(to_json_string(data.user_id)) as user_id,
        json_value(to_json_string(data.user_image_url.`$binary`)) as user_image_url,
        nullif(to_json_string(data.user_prompt_options), 'null') as user_prompt_options,
        json_value(to_json_string(data.user_prompt.`$binary`)) as user_prompt,
        json_value(to_json_string(data.valid_message)) as valid_message,
        json_value(to_json_string(data.validate_face_trace_id)) as validate_face_trace_id,
        json_value(to_json_string(data.workflow_name)) as workflow_name
    FROM `srpproduct-dc37e.mongo_production.gem-sensitive_replica_task`;