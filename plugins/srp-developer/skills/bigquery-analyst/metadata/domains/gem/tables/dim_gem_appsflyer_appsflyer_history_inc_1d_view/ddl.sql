CREATE VIEW `srpproduct-dc37e.favie_dw.dim_gem_appsflyer_appsflyer_history_inc_1d_view`
AS SELECT
  NULLIF(IDFV, 'NULL')  AS idfv,
  NULLIF(Device_Category, 'NULL')  AS device_category,
  NULLIF(Customer_User_ID, 'NULL')  AS customer_user_id,
  CAST(NULL AS STRING) AS bundle_id,
  CAST(NULL AS STRING) AS gp_broadcast_referrer,
  NULLIF(Event_Source, 'NULL')  AS event_source,
  NULLIF(App_Version, 'NULL')  AS app_version,
  NULLIF(City, 'NULL')  AS city,
  CAST(NULL AS STRING) AS selected_currency,
  NULLIF(App_Name, 'NULL')  AS app_name,
  CAST(NULL AS STRING) AS install_time_selected_timezone,
  NULLIF(Postal_Code, 'NULL')  AS postal_code,
  CAST(NULL AS BOOLEAN) AS wifi,
  SAFE_CAST(NULLIF(CAST(Install_Time AS STRING), 'NULL') AS TIMESTAMP) AS install_time,
  CAST(NULL AS STRING) AS device_download_time_selected_timezone,
  CAST(NULL AS STRING) AS api_version,
  SAFE_CAST(NULLIF(CAST(Is_Retargeting AS STRING), 'NULL') AS BOOLEAN) AS is_retargeting,
  NULLIF(Country_Code, 'NULL') AS country_code,
  NULLIF(AppsFlyer_ID, 'NULL') AS appsflyer_id,
  NULLIF(DMA, 'NULL') AS dma,
  CAST(NULL AS INTEGER) AS _sdc_table_version,
  NULLIF(Event_Revenue_Currency, 'NULL') AS event_revenue_currency,
  NULLIF(Media_Source, 'NULL') AS media_source,
  NULLIF(Region, 'NULL') AS region,
  NULLIF(Event_Value, 'NULL') AS event_value,
  NULLIF(IP, 'NULL') AS ip,
  SAFE_CAST(NULLIF(CAST(Event_Time AS STRING), 'NULL') AS TIMESTAMP) AS event_time,
  CAST(NULL AS TIMESTAMP) AS _sdc_received_at,
  CAST(NULL AS INTEGER) AS _sdc_sequence,
  CAST(NULL AS STRING) AS __sdc_primary_key,
  NULLIF(State, 'NULL') AS state,
  CAST(NULL AS STRING) AS device_type,
  NULLIF(IDFA, 'NULL') AS idfa,
  CAST(NULL AS STRING) AS device_download_time,
  NULLIF(Language, 'NULL') AS language,
  NULLIF(App_ID, 'NULL') AS app_id,
  CAST(NULL AS TIMESTAMP) AS _sdc_batched_at,
  NULLIF(Event_Name, 'NULL') AS event_name,
  NULLIF(OS_Version, 'NULL') AS os_version,
  NULLIF(Platform, 'NULL') AS platform,
  CAST(NULL AS STRING) AS selected_timezone,
  NULLIF(User_Agent, 'NULL') AS user_agent,
  SAFE_CAST(NULLIF(CAST(Is_Primary_Attribution AS STRING), 'NULL') AS BOOLEAN) AS is_primary_attribution,
  NULLIF(SDK_Version, 'NULL') AS sdk_version,
  CAST(NULL AS STRING) AS event_time_selected_timezone,
  CAST(NULL AS STRING) AS af_sub1,
  CAST(NULL AS BOOLEAN) AS is_lat,
  CAST(NULL AS STRING) AS gp_install_begin,
  NULLIF(Device_Model, 'NULL') AS device_model,
  CAST(NULL AS STRING) AS gp_referrer,
  CAST(NULLIF(Campaign_ID, 'NULL') AS STRING) AS af_c_id,
  CAST(NULL AS STRING) AS attributed_touch_time_selected_timezone,
  CAST(NULL AS STRING) AS engagement_type,
  NULLIF(Operator, 'NULL') AS operator,
  NULLIF(Attributed_Touch_Type, 'NULL') AS attributed_touch_type,
  NULLIF(Attribution_Lookback, 'NULL') AS af_attribution_lookback,
  CAST(NULL AS STRING) AS campaign_type,
  CAST(NULLIF(Adset_ID, 'NULL') AS STRING) AS af_adset_id,
  NULLIF(Retargeting_Conversion_Type, 'NULL') AS conversion_type,
  SAFE_CAST(NULLIF(CAST(Attributed_Touch_Time AS STRING), 'NULL') AS TIMESTAMP) AS attributed_touch_time,
  CAST(NULL AS STRING) AS gp_click_time,
  NULLIF(Match_Type, 'NULL') AS match_type,
  CAST(NULL AS STRING) AS event_type,
  NULLIF(HTTP_Referrer, 'NULL') AS http_referrer,
  CAST(NULL AS STRING) AS af_sub5,
  CAST(NULL AS STRING) AS af_prt,
  NULLIF(Campaign, 'NULL') AS campaign,
  CAST(NULL AS STRING) AS af_sub4,
  CAST(NULL AS STRING) AS af_sub2,
  NULLIF(Original_URL, 'NULL') AS original_url,
  CAST(NULL AS STRING) AS att,
  NULLIF(Adset, 'NULL') AS af_adset,
  NULLIF(Ad, 'NULL') AS af_ad,
  CAST(NULL AS INTEGER) AS network_account_id,
  CAST(NULL AS STRING) AS network_account_id__st,
  NULLIF(Channel, 'NULL') AS af_channel,
  NULLIF(Reengagement_Window, 'NULL') AS af_reengagement_window,
  CAST(NULL AS STRING) AS app_type,
  NULLIF(Site_ID, 'NULL') AS af_siteid,
  NULLIF(Ad_Type, 'NULL') AS af_ad_type,
  NULLIF(Carrier, 'NULL') AS carrier,
  CAST(NULL AS STRING) AS af_sub_siteid,
  NULLIF(Advertising_ID, 'NULL') AS advertising_id,
  CAST(NULL AS STRING) AS af_sub3,
  CAST(NULLIF(Ad_ID, 'NULL') AS STRING) AS af_ad_id,
  CAST(NULL AS STRING) AS store_reinstall,
  CAST(NULL AS STRING) AS af_keywords,
  CAST(NULL AS STRING) AS keyword_id,
  CAST(NULL AS STRING) AS amazon_aid

FROM `favie_dw.dim_gem_appsflyer_history_inc_1d`;